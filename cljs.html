<html>
<head>
    <script type='text/javascript' id='lt_ws' src='http://localhost:49181/socket.io/lighttable/ws.js'></script>

    <script type="text/javascript" src="js/CONSTANTS.js"></script>
    <script type="text/javascript" src="js/required.js"></script>
    <script type="text/javascript" src="js/cljs/dev.js"></script>
    <script type="text/javascript" src='js/lib/pixi.min.js'></script>
    <script type="text/javascript" src='js/lib/Perlin.js'></script>
    <script type="text/javascript" src='js/lib/pathfinding.min.js'></script>

    <script type="text/javascript" src="js/components/standard.js"></script>
    <script type="text/javascript" src="js/components/pixi/standard.js"></script>
    <script type="text/javascript" src="js/components/joe.js"></script>


    <link href="css/ce.css" type="text/css" rel="stylesheet">

</head>
<body>
<script>

    E.mandate(C.new.transform);





    makeActor = function(name){
        return E(name,
                C.new.actor(),
                C.new.sprite({image:"place/ball-shadow.png",
                               x:-32, y:4, alpha:0.7}),
                C.new.sprite({image:"place/ball.png"}),
                //C.new.rect({fill:0x10ffff, x:0, y:-10, h:6, w:TILESIZE}),
                C.new.wander());
    }






    makeMapLayer = function(name, opts){
        return E(name,
                 C.new.grid(),
                 C.new.background(opts));
    }


    actors = E("actors",
              makeActor("Joe"))

    for(var i=0;i<200;i++){
        actors.add(makeActor("colonist"));
    }

    map = E("map",
            makeMapLayer("terrain", {o:32}),
            actors
           )

    ui = E("ui",
           C.new.rect({fill:0x7cb3ff, h:30, w:WIDTH}),
           C.new.text({text:"This is the UI"}),
           C.new.text({text:"camera keys: arrows, '+' '-'", x:400})
          )

    root = E("game",
             C.new.loop(),
             C.new.renderer({w: 800, h: 600}),
             C.new.camera({target:"map"}),
             map,
             ui
            )











    PIXI.loader
      .add('assets/place.json')
      .add('assets/place.png')
      .add('assets/atlas.json')
      .add('assets/atlas.png')
      .load(function(){
        console.log("assets loaded");
        window.eventListen();
        E.mount(root);
      });



</script>
</body>
</html>

