<html>
<head>
    <script type="text/javascript" src="js/cljs/main.js"></script>
	<script type="text/javascript" src='js/lib/pixi.min.js'></script>

    <link href="css/ce.css" type="text/css" rel="stylesheet">

</head>
	<body>
        <script type="text/javascript" src="js/Constants.js"></script>

<script>

    window.locals = function(o){
     _o = new Array();
     for(k in o){if(o.hasOwnProperty(k)){_o.push(k);}}
     return _o;}



    C("pos", {x:0, y:0},
      {HTML:function(c){return "<"+c.x+","+c.y+">";}});


    C("actor",
      {name: "joe"},
      {init: function(c){
          console.log("init:" + c.name);
      },
       update: function(c){
           console.log(c.parent.pos.x, c.parent.pos.y);
       }})

    C("coords", [0, 1], {});

    C("wander", {speed:2},
      {update: function(c){
          c.parent.pos.x += Math.random() * c.speed - 0.5 * c.speed;
          c.parent.pos.y += Math.random() * c.speed - 0.5 * c.speed; }});


    makeActor = function(){
      return E( C.new.actor(),
                C.new.pos());}

    root = E(
        C.new.coords(),
        E(C.new.coords(),
          makeActor(),
          makeActor()),
        E(C.new.pos(),
          C.new.wander()),
        makeActor());


    E.init(root);
    E.update(root);
    E.update(root);

    window.inspect(root)

</script>
	</body>
</html>

